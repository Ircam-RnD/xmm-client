<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Documentation - Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/overrides.css">
</head>

<body>

<div id="main">

    <!-- if home page assume a title is already present in README -->
    
    <h1 class="page-title">Source: index.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * This library is developed by the ISMM (http://ismm.ircam.fr/) team at IRCAM,
 * within the context of the RAPID-MIX (http://rapidmix.goldsmithsdigital.com/)
 * project, funded by the European Union’s Horizon 2020 research and innovation programme.  
 * Original XMM code authored by Jules Françoise, ported to JavaScript by Joseph Larralde.  
 * See https://github.com/Ircam-RnD/xmm for detailed XMM credits.
 */

const isNode = new Function("try {return this===global;}catch(e){return false;}");

import { XMLHttpRequest as XHR } from 'xmlhttprequest';

export { default as GmmDecoder } from './gmm/gmm-decoder';
export { default as HhmmDecoder } from './hhmm/hhmm-decoder';
export { default as PhraseMaker } from './set/xmm-phrase';
export { default as SetMaker } from './set/xmm-set';

/**
 * @typedef xmmTrainingData
 */

/**
 * @typedef xmmModelConfig
 */

/**
 * Send a POST request to CoMo RESTful API and receive a trained model.
 * @param {Object} trainingData - Data needed by the API to train the model.
 * @param {String} [trainingData.url=https://como.ircam.fr/api/v1/train] - The API's url.
 * @param {Object} trainingData.configuration - The training configuration parameters.
 * @param {Object} trainingData.trainingSet - The examples used to train the model.
 */
const train = (data, callback) => {
  const url = data['url'] ? data['url'] : 'https://como.ircam.fr/api/v1/train';
  const xhr = isNode() ? new XHR() : new XMLHttpRequest();

  xhr.open('post', url, true);
  xhr.responseType = 'json';
  xhr.setRequestHeader('Access-Control-Allow-Origin', '*');
  xhr.setRequestHeader('Content-Type', 'application/json');

  if (isNode()) { // XMLHttpRequest module only supports xhr v1
    xhr.onreadystatechange = function() {
      if (xhr.readyState === 4) {
        callback(xhr.status, xhr.responseText);
      }
    }
  } else { // use xhr v2
    xhr.onload = function() {
      callback(xhr.status, xhr.response);
    }
    xhr.onerror = function() {
      callback(xhr.status, xhr.response);
    }
  }

  xhr.send(JSON.stringify(data));
};

/* * * * * * * * * * * * * * RAPID-MIX TRANSLATORS * * * * * * * * * * * * * */

////////// XMM => RAPID-MIX

const xmmToRapidMixTrainingSet = xmmSet => {
  // TODO
  return null;
}

////////// RAPID-MIX => XMM

const rapidMixToXmmTrainingSet = rmSet => {
  const s = rmSet.payload;

  const pm = new Xmm.PhraseMaker({
    bimodal: s.outputDimension > 0,
    dimension: s.inputDimension + s.outputDimension,
    dimensionInput: s.inputDimension,
  });
  const sm = new Xmm.SetMaker();

  for (let i in s.data) {
    pm.reset();
    pm.setConfig({ label: s.data[i].label });

    for (let j in s.data[i].inputData) {
      let v = s.data[i].inputData[j];

      if (s.outputDimension > 0) {
        v = v.concat(s.data[i].outputData[j]);
      }

      pm.addObservation(v);
    }

    sm.addPhrase(pm.getPhrase());
  }

  return sm.getTrainingSet();
}


export { train, xmmToRapidMixTrainingSet, rapidMixToXmmTrrainingSet };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="GmmDecoder.html">GmmDecoder</a></li><li><a href="HhmmDecoder.html">HhmmDecoder</a></li><li><a href="PhraseMaker.html">PhraseMaker</a></li><li><a href="SetMaker.html">SetMaker</a></li></ul><h3>Global</h3><ul><li><a href="global.html#train">train</a></li></ul>
</nav>

<br class="clear">

<footer>
    
        Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Aug 30 2017 13:08:05 GMT+0200 (CEST)
    
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
